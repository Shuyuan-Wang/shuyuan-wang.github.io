<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Hello World</title>
    <url>/2020/09/02/hello-world/</url>
    <content><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>
]]></content>
  </entry>
  <entry>
    <title>Leetcode SQL Questions</title>
    <url>/2020/09/02/Leetcode-SQL-Questions/</url>
    <content><![CDATA[<p>This is a post recording the SQL questions that I have made mistakes or encountered pitfalls.<br>Actively updating. I am using MySQL.</p>
<a id="more"></a>
<h2 id="Running-Total"><a href="#Running-Total" class="headerlink" title="Running Total"></a>Running Total</h2><h3 id="1-534-Game-Play-Analysis-III"><a href="#1-534-Game-Play-Analysis-III" class="headerlink" title="1. (534. Game Play Analysis III)"></a>1. (534. Game Play Analysis III)</h3><p>Write an SQL query that reports for each player and date, how many games played so far by the player. That is, the total number of games played by the player until that date. </p>
<p>The query result format is in the following example:</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">Activity table:</span><br><span class="line">+-----------+-----------+------------+--------------+</span><br><span class="line">| player_id | device_id | event_date | games_played |</span><br><span class="line">+-----------+-----------+------------+--------------+</span><br><span class="line">| <span class="number">1</span>         | <span class="number">2</span>         | <span class="number">2016</span><span class="number">-03</span><span class="number">-01</span> | <span class="number">5</span>            |</span><br><span class="line">| <span class="number">1</span>         | <span class="number">2</span>         | <span class="number">2016</span><span class="number">-05</span><span class="number">-02</span> | <span class="number">6</span>            |</span><br><span class="line">| <span class="number">1</span>         | <span class="number">3</span>         | <span class="number">2017</span><span class="number">-06</span><span class="number">-25</span> | <span class="number">1</span>            |</span><br><span class="line">| <span class="number">3</span>         | <span class="number">1</span>         | <span class="number">2016</span><span class="number">-03</span><span class="number">-02</span> | <span class="number">0</span>            |</span><br><span class="line">| <span class="number">3</span>         | <span class="number">4</span>         | <span class="number">2018</span><span class="number">-07</span><span class="number">-03</span> | <span class="number">5</span>            |</span><br><span class="line">+-----------+-----------+------------+--------------+</span><br><span class="line">Result table:</span><br><span class="line">+-----------+------------+---------------------+</span><br><span class="line">| <span class="number">1</span>         | <span class="number">2016</span><span class="number">-03</span><span class="number">-01</span> | <span class="number">5</span>                   |</span><br><span class="line">| <span class="number">1</span>         | <span class="number">2016</span><span class="number">-05</span><span class="number">-02</span> | <span class="number">11</span>                  |</span><br><span class="line">| <span class="number">1</span>         | <span class="number">2017</span><span class="number">-06</span><span class="number">-25</span> | <span class="number">12</span>                  |</span><br><span class="line">| <span class="number">3</span>         | <span class="number">2016</span><span class="number">-03</span><span class="number">-02</span> | <span class="number">0</span>                   |</span><br><span class="line">| <span class="number">3</span>         | <span class="number">2018</span><span class="number">-07</span><span class="number">-03</span> | <span class="number">5</span>                   |</span><br><span class="line">+-----------+------------+---------------------+</span><br><span class="line"></span><br><span class="line">For the player with id <span class="number">1</span>, <span class="number">5</span> + <span class="number">6</span> = <span class="number">11</span> games played by <span class="number">2016</span><span class="number">-05</span><span class="number">-02</span>, <span class="keyword">and</span> <span class="number">5</span> + <span class="number">6</span> + <span class="number">1</span> = <span class="number">12</span> games played by <span class="number">2017</span><span class="number">-06</span><span class="number">-25.</span></span><br><span class="line">For the player with id <span class="number">3</span>, <span class="number">0</span> + <span class="number">5</span> = <span class="number">5</span> games played by <span class="number">2018</span><span class="number">-07</span><span class="number">-03.</span></span><br><span class="line">Note that <span class="keyword">for</span> each player we only care about the days when the player logged <span class="keyword">in</span>.</span><br></pre></td></tr></table></figure>

<ul>
<li><p>Solution 1 (self join)</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    a.player_id, </span><br><span class="line">    a.event_date, </span><br><span class="line">    <span class="keyword">SUM</span>(b.games_played) <span class="keyword">AS</span> games_played_so_far</span><br><span class="line"><span class="keyword">FROM</span> </span><br><span class="line">    Activity a, Activity b</span><br><span class="line"><span class="keyword">WHERE</span> a.event_date &gt;= b.event_date <span class="keyword">AND</span> a.player_id = b.player_id</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> a.player_id, a.event_date</span><br></pre></td></tr></table></figure>
</li>
<li><p>Solution 2 (window function)</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> player_id, event_date, </span><br><span class="line">			<span class="keyword">sum</span>(games_played) <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> player_id </span><br><span class="line">            <span class="keyword">order</span> <span class="keyword">by</span> player_id, event_date) <span class="keyword">as</span> games_played_so_far</span><br><span class="line"><span class="keyword">from</span> activity</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> player_id, event_date</span><br></pre></td></tr></table></figure></li>
</ul>
]]></content>
      <categories>
        <category>SQL</category>
      </categories>
      <tags>
        <tag>SQL, Leetcode</tag>
      </tags>
  </entry>
  <entry>
    <title>Realtime Twitter Mentioned Users Analysis using Spark Streaming during USOpen 2020</title>
    <url>/2020/09/11/twitter_usopen/</url>
    <content><![CDATA[<p>In this project, I obtained realtime tweets using <a href="https://github.com/bear/python-twitter">python-twitter</a> wrapper, and then processed the tweets using Apache Spark Streaming to identify mentioned users with search keyword <em>USOpen</em>, and finally returned top 20 popular mentioned users and visualized them with bar plots.</p>
<a id="more"></a>

<h2 id="1-Obtain-realtime-tweets-from-Twitter"><a href="#1-Obtain-realtime-tweets-from-Twitter" class="headerlink" title="1. Obtain realtime tweets from Twitter"></a>1. Obtain realtime tweets from Twitter</h2><h3 id="Step-1-1-Apply-for-Twitter-developer-account"><a href="#Step-1-1-Apply-for-Twitter-developer-account" class="headerlink" title="Step 1.1 Apply for Twitter developer account"></a>Step 1.1 Apply for Twitter developer account</h3><p>Upgrade Twitter account to developer account on <a href="https://apps.twitter.com/">apps.twitter</a> and create an app to get the consumer keys and authentication tokens.</p>
<h3 id="Step-1-2-Install-the-python-twitter-wrapper"><a href="#Step-1-2-Install-the-python-twitter-wrapper" class="headerlink" title="Step 1.2 Install the python-twitter wrapper"></a>Step 1.2 Install the python-twitter wrapper</h3><p>With the keys and tokens of newly created Twitter App and the help of <a href="https://github.com/bear/python-twitter">python-twitter</a> wrapper, I easily extracted the tweet text from Twitter and sent the information to Spark via TCP connection using Python Socket package. (For <a href="https://docs.python.org/3/library/socket.html">official document</a> of Socket, for <a href="https://zhuanlan.zhihu.com/p/39982451">brief introduction</a>.)</p>
<h2 id="2-Establish-Apache-Spark-Streaming-application"><a href="#2-Establish-Apache-Spark-Streaming-application" class="headerlink" title="2. Establish Apache Spark Streaming application"></a>2. Establish Apache Spark Streaming application</h2><p>As a powerful big data tool, Spark is able to process the realtime stream data and transform it to get the information we need. More specifically, I used Spark to receive the tweets and extract the user (the word begin with <strong>@</strong>, excluding the keyword itself), and calculate the number of times a user was mentioned. </p>
<h2 id="3-Analyze-data"><a href="#3-Analyze-data" class="headerlink" title="3. Analyze data"></a>3. Analyze data</h2><p>USOpen is one of the major tennis championships in the year. Due to the COVID-19 pandemic, USOpen 2020 is held in Flushing, New York with no audience at present. People watch the matches through online platform. One of the ways to capture the trending of the game is via Twitter. Therefore, I set up the realtime data gathering and transformation pipeline to see the up-trending players as the game proceeds.</p>
<h3 id="2020-09-10-17-00-after-Men’s-Doubles-Final"><a href="#2020-09-10-17-00-after-Men’s-Doubles-Final" class="headerlink" title="2020-09-10 17:00, after Men’s Doubles Final"></a>2020-09-10 17:00, after Men’s Doubles Final</h3><p>Mate Pavia &amp; Bruno Soares defeat Koolhof &amp; Mektic in the game. It is their first Grand Slam title together. As is shown in the barplot, <strong>@brunosoares82</strong>, the Twitter account for Bruno Soares is quite popular at the time when the code was run. Mate Pavia doesn’t have Twitter account, so he is not shown in the top mentioned Twitter user. </p>
<p>As Women’s Singles Semifinals are to be on at the same day at 19:00, the candidates Naomi Osaka (No.4 seed, <strong>@naomiosaka</strong>) and Serena Williams (No.3 seed, <strong>@serenawilliams</strong>) are also popular.</p>
<p><img src="/images/0910-17.gif"></p>
<h3 id="2020-09-10-21-30-after-Women’s-Single-Semifinal-1"><a href="#2020-09-10-21-30-after-Women’s-Single-Semifinal-1" class="headerlink" title="2020-09-10 21:30, after Women’s Single Semifinal -1"></a>2020-09-10 21:30, after Women’s Single Semifinal -1</h3><p>Naomi Osaka beats Jennifer Brady. This is an exciting and fantastic match, with a tied at the first set. This is Osaka’s 3rd career Grand Slam final. People are thrilled at the result and looking forward to seeing her in the final. The strong support for Osaka could be seen from the number of times her Twitter account is mentioned after the semifinal.</p>
<p><img src="/images/0910-21.gif"></p>
<h3 id="2020-09-11-00-00-after-Women’s-Single-Semifinal-2"><a href="#2020-09-11-00-00-after-Women’s-Single-Semifinal-2" class="headerlink" title="2020-09-11 00:00, after Women’s Single Semifinal -2"></a>2020-09-11 00:00, after Women’s Single Semifinal -2</h3><p>This is Victoria Azarenka’s (<strong>@vika7</strong>) first major final in seven years! She beats Serena Williams with 1-6, 6-3, 6-3. I watch this match in live stream, and Azarenka is so impressive! Although people hate to see Serena lose the match, they are glad to see Azarenka doing well again and going to the final of the USOpen from unseeded. Azarenka will battle Osaka in the Women’s Single Final, and the match would be so much fun because the two player are former finalist and former champion, respectively. Therefore, <strong>@vika7</strong>, <strong>@serenawilliams</strong>, <strong>@naomiosaka</strong> are top-trending after this semifinal. By the way, <strong>@espn</strong> is also mentioned so many times because it is the media that provides live stream service and people re-tweet its tweet after it announces the victory of Azarenka. </p>
<p><img src="/images/0911-00.gif"></p>
<h3 id="2020-09-11-15-00-after-Women’s-Doubles-Final-and-before-Men’s-Single-Semifinals"><a href="#2020-09-11-15-00-after-Women’s-Doubles-Final-and-before-Men’s-Single-Semifinals" class="headerlink" title="2020-09-11 15:00, after Women’s Doubles Final and before Men’s Single Semifinals"></a>2020-09-11 15:00, after Women’s Doubles Final and before Men’s Single Semifinals</h3><p>Laura Siegemund (<strong>@laurasiegemund</strong>) and Vera Zvonareva (<strong>@verazvonareva</strong>) win Women’s Doubles Final and have their first Grand Slam together. Their Twitter accounts are mentioned multiple times and are shown in the bar plots. However, the accounts that are more popular are Mariah Carey (<strong>@mariahcarey</strong>) who will perform SAVE THE DAY tomorrow at the Women’s Single Finals, Dominic Thiem (No.2 seed, <strong>@theimdomi</strong>),  Pablo Carreno Busta (No.20 seed, <strong>@pablocarreno91</strong>), Daniil Medvedev (No.3 seed, <strong>@daniilmedwed</strong>) who will compete in the Men’s Single Semifinals an hour later. It suggests that people are likely to pay more attention to Men’s Single Semifinals, and Mariah Carey than the Women’s Doubles Final. </p>
<p><img src="/images/0911-15.gif"></p>
]]></content>
      <tags>
        <tag>Twitter, Apache Spark, USOpen</tag>
      </tags>
  </entry>
</search>
